---
#
# Installing Filebeat
#

# download Filebeat 
- name: "download filebeat rpm"
  get_url: 
  args:
    url: https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-oss-7.5.0-x86_64.rpm
    dest: /tmp/filebeat-oss-7.5.0-x86_64.rpm
    force: no

 #Install filebeat"
- name: "Install filebeat rpm"
  become: true
  yum: name=/tmp/filebeat-oss-7.5.0-x86_64.rpm state=present


#Configure Filebeat yml file 

- name: Copy filebeat.yml onto ec2
  copy: 
    src: ../../filebeat/templates/filebeat.yml
    dest: /etc/filebeat/
    backup: yes
  become: true

# Starting Filebeat
- name: Starting Filebeat
  service:
   name: filebeat
   state: started
   enabled: true
  become: true

 
